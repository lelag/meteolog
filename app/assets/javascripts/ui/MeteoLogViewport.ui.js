/*
 * File: MeteoLogViewport.ui.js
 * Date: Sun Dec 18 2011 23:50:15 GMT+0100 (CET)
 *
 * This file was generated by Ext Designer version 1.2.2.
 * http://www.sencha.com/products/designer/
 *
 * This file will be auto-generated each and everytime you export.
 *
 * Do NOT hand edit this file.
 */

function isOldIE() {
  return Ext.IE6 || Ext.isIE7 || Ext.isIE8;
}

MeteoLogViewportUi = Ext.extend(Ext.Viewport, {
    layout: 'border',
    firstLoad: true,
    registerElement: function(el) {
      if(!this.registerStore)
        this.registerStore = {};
        this.registerStore[el.ident] = el;
    },
    getReg: function(ident) {
      return this.registerStore[ident];
    },
    initComponent: function() {
        var me = this;
        Ext.applyIf(this, {
            items: [
                {
                    xtype: 'ml_map',
                    region: 'center',
                    ident: 'ml_map',
                    listeners: {
                      render: function(e) {
                        me.registerElement(e);
                      },
                      map_click: function(map, lonlat) {
                        me.getReg('details').expand();
                        me.getReg('details').setStationNear(lonlat);
                      },
                      new_map_data: function(map, max) {
                        me.getReg('ml_control').resetSlider(max);
                        if(me.firstLoad) {
                          Ext.get('beta').shift({ y: 100, duration:1} );
                          me.firstLoad = false;
                        }
                      }
                    }
                },
                {
                    xtype: 'ml_control',
                    region: 'south',
                    ident:'ml_control',
                    listeners: {
                      render: function(e) {
                        me.registerElement(e);
                      },
                      slider_change: function(s, n, o) {
                        me.getReg('ml_map').sliderChanged(s, n, o);
                        me.getReg('details').sliderChanged(s, n, o);
                      }
                    }
                },
                {
                    xtype: 'panel',
                    width: 400,
                    activeItem: 0,
                    layout: 'accordion',
                    collapsible: true,
                    title: 'Options',
                    collapsible: true,
                    region: 'east',
                    split: true,
                    items: [
                        {
                            xtype: 'panel',
                            border: false,
                            title: 'Help',
                            contentEl:'apropos-et-aide'
                        },
                        {
                            xtype: 'details_reader',
                            border: false,
                            ident:'details',
                            listeners: {
                              render: function(e) {
                                me.registerElement(e);
                              },
                              station_selected: function(dr, st) {
                                me.getReg('ml_map').setStationMarker(st);
                              },
                              rowclick: function(g, i, e) {
                                me.getReg('ml_control').setSlider(i);
                              }
                            }
                        }
                    ]
                }
            ]
        });

        MeteoLogViewportUi.superclass.initComponent.call(this);
    }
});
